# Church Attendance Dashboard – Agent Guidelines

## Repository-wide
- Format HTML, CSS, and JS with two-space indentation, keep semicolons, and prefer single quotes in JS to match the existing files.​:codex-file-citation[codex-file-citation]{line_range_start=4 line_range_end=136 path=assets/main.js git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/assets/main.js#L4-L136"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=190 path=assets/styles.css git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/assets/styles.css#L1-L190"}​
- Leave the frontend as plain ES modules loaded from the HTML shell (no bundlers or transpilation). Chart.js is pulled from the CDN and `assets/main.js` is imported directly—keep that pattern when adding entry points.​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=205 path=index.html git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/index.html#L1-L205"}​
- Use modern `const`/`let`, arrow functions, and template literals like the current codebase.​:codex-file-citation[codex-file-citation]{line_range_start=44 line_range_end=711 path=assets/main.js git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/assets/main.js#L44-L711"}​
- Keep HTML attribute quoting and accessibility semantics consistent (e.g., `role="status"`, ARIA labels, and semantic sections).​:codex-file-citation[codex-file-citation]{line_range_start=29 line_range_end=229 path=index.html git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/index.html#L29-L229"}​

## Testing & validation
- Run `node scripts/testCsvSecurity.mjs` after touching CSV parsing, upload handling, or the dataset security helpers.​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=83 path=scripts/testCsvSecurity.mjs git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/scripts/testCsvSecurity.mjs#L1-L83"}​
- If you regenerate or tweak the placeholder dataset, run `node scripts/generateAttendanceData.js` so both `data/attendance.json` and `data/attendance.csv` stay in sync.​:codex-file-citation[codex-file-citation]{line_range_start=150 line_range_end=169 path=scripts/generateAttendanceData.js git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/scripts/generateAttendanceData.js#L150-L169"}​

## Frontend (index.html, assets/)
- Add DOM references to the `elements` map and rely on the shared `state` object instead of ad-hoc queries to stay consistent with existing patterns.​:codex-file-citation[codex-file-citation]{line_range_start=4 line_range_end=36 path=assets/main.js git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/assets/main.js#L4-L36"}​
- Hook new behavior into the `updateDashboard` pipeline so charts, summaries, and tables remain in sync.​:codex-file-citation[codex-file-citation]{line_range_start=702 line_range_end=711 path=assets/main.js git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/assets/main.js#L702-L711"}​
- Use the existing toggle utilities for filter controls (`registerMultiSelectToggle`, `registerSingleSelectToggle`) when introducing new selectors or keyboard interactions.​:codex-file-citation[codex-file-citation]{line_range_start=714 line_range_end=860 path=assets/main.js git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/assets/main.js#L714-L860"}​
- Preserve dataset status messaging and reuse `applyDataset`/`setDatasetStatus` when swapping data sources.​:codex-file-citation[codex-file-citation]{line_range_start=150 line_range_end=158 path=assets/main.js git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/assets/main.js#L150-L158"}​​:codex-file-citation[codex-file-citation]{line_range_start=874 line_range_end=896 path=assets/main.js git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/assets/main.js#L874-L896"}​
- Keep relying on `parseCsv`, `parseIsoDateLocal`, and the CSV security helpers rather than reimplementing parsing logic.​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=101 path=assets/csvParser.mjs git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/assets/csvParser.mjs#L1-L101"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=53 path=assets/csvSecurity.mjs git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/assets/csvSecurity.mjs#L1-L53"}​
- Maintain accessibility text and ARIA attributes for new charts or controls; mirror the existing markup in `index.html` when extending the UI.​:codex-file-citation[codex-file-citation]{line_range_start=29 line_range_end=205 path=index.html git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/index.html#L29-L205"}​

## Styles (assets/styles.css)
- Extend the CSS design tokens under `:root` and prefer existing class naming conventions for layout/components.​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=190 path=assets/styles.css git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/assets/styles.css#L1-L190"}​
- Reuse button and control styles such as `.pill-button` and `.toggle-button` rather than introducing new variants unless necessary.​:codex-file-citation[codex-file-citation]{line_range_start=97 line_range_end=200 path=assets/styles.css git_url="https://github.com/mbaldwinsmith/churchdatadashboard/blob/main/assets/styles.css#L97-L200"}​
