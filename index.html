<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Church Attendance Dashboard</title>
    <link rel="stylesheet" href="assets/styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  </head>
  <body>
    <header class="page-header">
      <div>
        <h1>Church Attendance Dashboard</h1>
        <p class="subtitle">
          Explore weekly attendance and kids check-in trends tailored to the
          filters and dataset you choose.
        </p>
      </div>
    </header>

    <main>
      <section class="data-management" aria-labelledby="dataManagementHeading">
        <article class="data-card">
          <h2 id="dataManagementHeading">Data source</h2>
          <p id="datasetStatus" class="dataset-status" role="status">
            Using placeholder dataset generated for Central and North sites (2022â€“2024).
          </p>
          <div class="data-actions">
            <label class="file-upload">
              <span>Upload CSV dataset</span>
              <input type="file" id="datasetUpload" accept=".csv" />
            </label>
            <button type="button" id="resetDataset" class="pill-button secondary">Reset to placeholder</button>
            <a class="pill-button" href="data/attendance.csv" download>Download sample CSV</a>
          </div>
          <details class="guidelines">
            <summary>CSV formatting guidelines</summary>
            <ul>
              <li>
                Include a header row with the following columns: Week, Date, Year, Month, Site, Service,
                Attendance, Kids Checked-in.
              </li>
              <li>Use ISO format (<code>YYYY-MM-DD</code>) for the Date column.</li>
              <li>Year and Month should be stored as text (e.g. <code>2024</code>, <code>September</code>).</li>
              <li>Attendance and Kids Checked-in must contain whole numbers.</li>
              <li>Provide one row per site, service, and Sunday combination.</li>
            </ul>
          </details>
        </article>
      </section>
    
      <section class="controls">
        <div class="control-group">
          <label for="yearSelect">Year</label>
          <select id="yearSelect"></select>
        </div>
        <div class="control-group">
          <label for="siteSelect">Site</label>
          <select id="siteSelect"></select>
        </div>
        <div class="control-group">
          <label for="serviceSelect">Service</label>
          <select id="serviceSelect"></select>
        </div>
        <div class="control-group metric-toggle">
          <span>Metric</span>
          <label>
            <input type="radio" name="metric" value="Attendance" checked />
            Attendance
          </label>
          <label>
            <input type="radio" name="metric" value="Kids Checked-in" />
            Kids Checked-in
          </label>
        </div>
      </section>

      <section class="filters-summary">
        <p id="activeFilters"></p>
      </section>

      <section class="summaries" aria-live="polite">
        <article class="summary-card">
          <h2>Total</h2>
          <p id="summaryTotal" class="summary-value">0</p>
          <p class="summary-label" id="summaryTotalLabel">Total Attendance</p>
        </article>
        <article class="summary-card">
          <h2>Average per Week</h2>
          <p id="summaryAverage" class="summary-value">0</p>
          <p class="summary-label">Based on available Sundays</p>
        </article>
        <article class="summary-card">
          <h2>Peak Week</h2>
          <p id="summaryPeak" class="summary-value">0</p>
          <p class="summary-label" id="summaryPeakLabel"></p>
        </article>
        <article class="summary-card">
          <h2>Top Group</h2>
          <p id="summaryTopGroup" class="summary-value">0</p>
          <p class="summary-label" id="summaryTopGroupLabel"></p>
        </article>
      </section>

      <section class="charts">
        <article class="chart-card">
          <div class="chart-header">
            <h2>Weekly Trend</h2>
            <p>Aggregated by Sunday</p>
          </div>
          <canvas id="trendChart" height="220"></canvas>
        </article>
        <article class="chart-card">
          <div class="chart-header">
            <h2>Monthly Overview</h2>
            <p>Totals grouped by month</p>
          </div>
          <canvas id="monthlyChart" height="220"></canvas>
        </article>
        <article class="chart-card">
          <div class="chart-header">
            <h2>Distribution</h2>
            <p id="distributionLabel">Share by service</p>
          </div>
          <canvas id="distributionChart" height="220"></canvas>
        </article>
      </section>

      <section class="table-section">
        <div class="table-header">
          <h2>Recent Weeks</h2>
          <p>Showing the latest 50 entries based on the selected filters.</p>
        </div>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Week</th>
                <th>Date</th>
                <th>Site</th>
                <th>Service</th>
                <th id="metricHeader">Attendance</th>
                <th id="secondaryMetricHeader">Kids Checked-in</th>
              </tr>
            </thead>
            <tbody id="tableBody"></tbody>
          </table>
        </div>
      </section>
    </main>

    <footer>
      <p>Placeholder data generated for demonstration purposes.</p>
    </footer>

    <script type="module" src="assets/main.js"></script>
  </body>
</html>
